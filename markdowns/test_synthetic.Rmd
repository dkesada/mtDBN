---
title: "Testing DBNTree on synthetic data"
author: "David Quesada"
date: "22/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Testing mtDBN on synthetic data

This markdown document will follow the experimental procedures of applying the mtDBN model to the synthetic dataset generated by the 'dt_generation_notebook.Rmd' markdown. The objective of these experiments is to show the better performance of mtDBN models over regular DBN models when dealing with non-linear relationships and non-stationary time-series. 

First, the synthetic dataset will be split in 67% train and 33% test. With that train dataset, both the mtDBN and regular DBN models will be trained and then they will perform forecasting on the test cycles. 

## Dataset split

```{r init}
library(dbnR)
library(mtDBN)
library(data.table)
```

```{r test cycle}
set.seed(42)
y <- c(S_c = 0.001, C_a = 50, T_1 = 200, T_2 = 400)
# Fluid rho and C_p equal to those of oil in kg/m3 and mW/(m K) respectively
# Tube rho and C_p equal to those of steel with 1% carbon in kg/m3 and W/(m K) respectively
params <- list(A_2 = 0.01, A_3 = 0.52e2, A_3_p = 0.52e2, A_4 = 0.08, 
               A_5 = 10.8e3, A_5_p = 10.8e3, R = 8.314463, A_1 = 0.3,
               rho_1 = 847, C_p1 = 0.12, rho_2 = 8050, C_p2 = 43, eps_2 = 0.4e-05,
               m_c = 0.5, t_min = 800, t_max = 1300, vol = 20,
               delta_p = 12e5, mu_1 = 30, l = 1, Tin = 50, r = 0.019, A_6 = 0.1, Q_in = 80)
times <- seq(0, 99)

res <- ode_var_params(y = y, times = times, foo = coupled_Sc_Ca_t1_t2_t3_vol, params = params)

plot(res)
```
