---
title: "Testing DBNTree on synthetic data"
author: "David Quesada"
date: "22/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Testing mtDBN on synthetic data

This markdown document will follow the experimental procedures of applying the mtDBN model to the synthetic dataset generated by the 'dt_generation_notebook.Rmd' markdown. The objective of these experiments is to show the better performance of mtDBN models over regular DBN models when dealing with non-linear relationships and non-stationary time-series. 

First, the synthetic dataset will be split in 67% train and 33% test. With that train dataset, both the mtDBN and regular DBN models will be trained and then they will perform forecasting on the test cycles. 

## Dataset split

To begin the experiment, we will split the dataset into train and test, where 67% will be training data and 33% will be test. This split will be done by selection whole cycles from the original dataset. Once the split is performed, the datasets have to be folded to size = 2 and the instances that have overlapping values from different cycles have to be removed.

```{r init}
library(dbnR)
library(mtDBN)
library(data.table)
```

```{r prepare datasets}
dt <- fread("../dataset/dt_cycles.csv")
dt[, time := NULL]
set.seed(42)
train_p <- 0.67

ids <- dt[, unique(cyc)]
train_ids <- sample(ids, round(length(ids) * train_p), replace = F)

dt_train <- dt[cyc %in% train_ids]
dt_test <- dt[!(cyc %in% train_ids)]

size <- 2
id_var <- "cyc"

f_dt_train <- dbnR::filtered_fold_dt(dt_train, size, id_var)
f_dt_test <- dbnR::filtered_fold_dt(dt_test, size, id_var)
dt_train[, (id_var) := NULL]
dt_test[, (id_var) := NULL]
```
